
var comp = function (engine) {
engine.directive('lt', function (model, compile, analyse) {
  switch (analyse(model)) {
    case '[scalar]': return function (x) { return model.some(function (y) { return x < y; }) };
    default: return function (x) { return x < model; };
  }
});

engine.directive('gt', function (model, compile, analyse) {
  switch (analyse(model)) {
    case '[scalar]': return function (x) { return model.some(function (y) { return x > y; }) };
    default: return function (x) { return x > model; };
  }
});
};

var engine = specs.engine(comp);

engine.directive('count', function (model, compile, analyse) {
  var cspec = compile(model._mustBe);
  var specs = model._in.map(compile);
  return function (x) {
    var count = specs.reduce(function (c, spec) { return c + (spec(x) ? 1 : 0); }, 0);
    return cspec(count);
  }
});
